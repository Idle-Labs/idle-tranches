// SPDX-License-Identifier: MIT
pragma solidity 0.8.10;
import "forge-std/Test.sol";
import 'forge-std/console.sol';
// import "../../contracts/IdleTokenFungible.sol";
import "../../contracts/interfaces/IIdleToken.sol";
import "../../contracts/interfaces/IProxyAdmin.sol";
import "../../contracts/strategies/lido/IdleLidoStrategy.sol";

contract SamsterTest is Test {

  uint256 internal constant blockNumber = 17218126;
  address internal constant idleUSDC = 0x5274891bEC421B39D23760c04A6755eCB444797C;
  address internal constant stETHLidoStrategy = 0x0cac674ebD77bBD899f6079932768f6d59Da089A;
  bytes constant IdleTokenRunTimeCode = hex'608060405234801561001057600080fd5b506004361061034e5760003560e01c806301d22ccd1461035357806306fdde0314610377578063095ea7b3146103f45780630b56d157146104345780630df94ef21461045357806312ea5c7e1461048b5780631624f6c6146104e357806318160ddd14610611578063194a62a8146106195780631f80b18a146106365780631fc29c011461063e57806323b872dd1461064657806323d39ab51461067c5780632b1b4bb0146106845780632befabbf146106aa5780632fdc91ee146106de578063313ce567146106e657806336a000821461070457806339509351146107215780633f4ba83a1461074d578063412753581461075557806345c8026c1461075d57806346fbf68e146107835780634847cdc8146107a95780634c69c00f146107b15780634cb71222146107d757806350b28af7146107fd5780635478786c14610823578063549245071461082b5780635c975abb146108335780635cffe9de1461083b5780635f09d84c146108c9578063613255ab146108ef5780636287fe211461091557806365ed6e231461093b57806369fe0e2d146109435780636c11ec96146109605780636cfd1553146109865780636ef8d66d146109ac57806370a08231146109b4578063715018a6146109da578063746daa4e146109e25780637d7c2a1c146109ff5780637dc0d1d014610a075780637ff9b59614610a0f5780638129fc1c14610a1757806382dc1ec414610a1f5780638456cb5914610a455780638705fcd414610a4d5780638a279e8a14610a735780638b30b51614610aa15780638cba144414610abe5780638da5cb5b14610ae45780638f32d59b14610aec57806395d89b4114610af45780639602e9f814610afc578063a457c2d714610b04578063a6ea311c14610b30578063a9059cbb14610b38578063aaa48e9f14610b64578063afdd3fc314610b8a578063b13bd49114610ba7578063b616b63d14610c48578063b71501bc14610cbd578063c498c51514610cc5578063c4d66de814610d33578063cb390f9714610d59578063d9d98ce414610d61578063dd62ed3e14610d8d578063ddca3f4314610dbb578063f16c88db14610dc3578063f2d50ba614610f21578063f2fde38b14610f29578063fc0c546a14610f4f575b600080fd5b61035b610f57565b604080516001600160a01b039092168252519081900360200190f35b61037f610f67565b6040805160208082528351818301528351919283929083019185019080838360005b838110156103b95781810151838201526020016103a1565b50505050905090810190601f1680156103e65780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6104206004803603604081101561040a57600080fd5b506001600160a01b038135169060200135610ffe565b604080519115158252519081900360200190f35b6104516004803603602081101561044a57600080fd5b503561101c565b005b6104796004803603602081101561046957600080fd5b50356001600160a01b03166110a8565b60408051918252519081900360200190f35b6104936110bb565b60408051602080825283518183015283519192839290830191858101910280838360005b838110156104cf5781810151838201526020016104b7565b505050509050019250505060405180910390f35b610451600480360360608110156104f957600080fd5b810190602081018135600160201b81111561051357600080fd5b82018360208201111561052557600080fd5b803590602001918460018302840111600160201b8311171561054657600080fd5b91908080601f0160208091040260200160405190810160405280939291908181526020018383808284376000920191909152509295949360208101935035915050600160201b81111561059857600080fd5b8201836020820111156105aa57600080fd5b803590602001918460018302840111600160201b831117156105cb57600080fd5b91908080601f0160208091040260200160405190810160405280939291908181526020018383808284376000920191909152509295505050903560ff16915061111d9050565b6104796111f9565b6104516004803603602081101561062f57600080fd5b50356111ff565b610479611395565b61035b61142d565b6104206004803603606081101561065c57600080fd5b506001600160a01b03813581169160208101359091169060400135611445565b61035b6114cd565b61035b6004803603602081101561069a57600080fd5b50356001600160a01b03166114dd565b610479600480360360608110156106c057600080fd5b508035906020810135151590604001356001600160a01b03166114ff565b61035b6116a2565b6106ee6116b2565b6040805160ff9092168252519081900360200190f35b61035b6004803603602081101561071a57600080fd5b50356116bb565b6104206004803603604081101561073757600080fd5b506001600160a01b0381351690602001356116e3565b610451611737565b61035b611822565b61035b6004803603602081101561077357600080fd5b50356001600160a01b0316611832565b6104206004803603602081101561079957600080fd5b50356001600160a01b031661184e565b610479611862565b610451600480360360208110156107c757600080fd5b50356001600160a01b0316611869565b610451600480360360208110156107ed57600080fd5b50356001600160a01b0316611904565b6104936004803603602081101561081357600080fd5b50356001600160a01b031661199f565b61035b611a8f565b610479611aa7565b610420611aae565b6104206004803603608081101561085157600080fd5b6001600160a01b03823581169260208101359091169160408201359190810190608081016060820135600160201b81111561088b57600080fd5b82018360208201111561089d57600080fd5b803590602001918460018302840111600160201b831117156108be57600080fd5b509092509050611ab8565b610451600480360360208110156108df57600080fd5b50356001600160a01b0316611b19565b6104796004803603602081101561090557600080fd5b50356001600160a01b0316611bb4565b6104796004803603602081101561092b57600080fd5b50356001600160a01b0316611c00565b610493611c13565b6104516004803603602081101561095957600080fd5b5035611c6b565b6104516004803603602081101561097657600080fd5b50356001600160a01b0316611cf3565b6104516004803603602081101561099c57600080fd5b50356001600160a01b0316611d8e565b610451611e29565b610479600480360360208110156109ca57600080fd5b50356001600160a01b0316611e3b565b610451611e56565b61035b600480360360208110156109f857600080fd5b5035611ed5565b610420611ee3565b61035b611ef2565b610479611f02565b610451611f0c565b61045160048036036020811015610a3557600080fd5b50356001600160a01b0316611fb2565b610451612001565b61045160048036036020811015610a6357600080fd5b50356001600160a01b03166120ca565b61047960048036036040811015610a8957600080fd5b506001600160a01b0381358116916020013516612165565b61047960048036036020811015610ab757600080fd5b5035612183565b61047960048036036020811015610ad457600080fd5b50356001600160a01b03166121bf565b61035b61224b565b61042061225a565b61037f612280565b61035b6122e1565b61042060048036036040811015610b1a57600080fd5b506001600160a01b0381351690602001356122f9565b610493612367565b61042060048036036040811015610b4e57600080fd5b506001600160a01b0381351690602001356123c8565b61047960048036036020811015610b7a57600080fd5b50356001600160a01b03166123fe565b61047960048036036020811015610ba057600080fd5b5035612411565b610baf612430565b604051808060200180602001838103835285818151815260200191508051906020019060200280838360005b83811015610bf3578181015183820152602001610bdb565b50505050905001838103825284818151815260200191508051906020019060200280838360005b83811015610c32578181015183820152602001610c1a565b5050505090500194505050505060405180910390f35b61047960048036036040811015610c5e57600080fd5b81359190810190604081016020820135600160201b811115610c7f57600080fd5b820183602082011115610c9157600080fd5b803590602001918460208302840111600160201b83111715610cb257600080fd5b5090925090506125d6565b61035b61261d565b61045160048036036020811015610cdb57600080fd5b810190602081018135600160201b811115610cf557600080fd5b820183602082011115610d0757600080fd5b803590602001918460208302840111600160201b83111715610d2857600080fd5b509092509050612635565b61045160048036036020811015610d4957600080fd5b50356001600160a01b03166126d8565b61042061278e565b61047960048036036040811015610d7757600080fd5b506001600160a01b038135169060200135612798565b61047960048036036040811015610da357600080fd5b506001600160a01b03813581169160200135166127ff565b61047961282a565b61045160048036036080811015610dd957600080fd5b810190602081018135600160201b811115610df357600080fd5b820183602082011115610e0557600080fd5b803590602001918460208302840111600160201b83111715610e2657600080fd5b919390929091602081019035600160201b811115610e4357600080fd5b820183602082011115610e5557600080fd5b803590602001918460208302840111600160201b83111715610e7657600080fd5b919390929091602081019035600160201b811115610e9357600080fd5b820183602082011115610ea557600080fd5b803590602001918460208302840111600160201b83111715610ec657600080fd5b919390929091602081019035600160201b811115610ee357600080fd5b820183602082011115610ef557600080fd5b803590602001918460208302840111600160201b83111715610f1657600080fd5b509092509050612831565b610479612a81565b61045160048036036020811015610f3f57600080fd5b50356001600160a01b0316612a88565b61035b612ad8565b61016d546001600160a01b031681565b60688054604080516020601f6002600019610100600188161502019095169490940493840181900481028201810190925282815260609390929091830182828015610ff35780601f10610fc857610100808354040283529160200191610ff3565b820191906000526020600020905b815481529060010190602001808311610fd657829003601f168201915b505050505090505b90565b600061101261100b612ae8565b8484612aec565b5060015b92915050565b61102461225a565b611063576040805162461bcd60e51b81526020600482018190526024820152600080516020616270833981519152604482015290519081900360640190fd5b620186a08161017181905511156110a5576040805162461bcd60e51b81526020600482015260016024820152603560f81b604482015290519081900360640190fd5b50565b6101766020526000908152604090205481565b6060610173805480602002602001604051908101604052809291908181526020018280548015610ff357602002820191906000526020600020905b81546001600160a01b031681526001909101906020018083116110f6575050505050905090565b600054610100900460ff16806111365750611136612bd8565b80611144575060005460ff16155b61117f5760405162461bcd60e51b815260040180806020018281038252602e8152602001806162d2602e913960400191505060405180910390fd5b600054610100900460ff161580156111aa576000805460ff1961ff0019909116610100171660011790555b83516111bd906068906020870190615f6f565b5082516111d1906069906020860190615f6f565b50606a805460ff191660ff841617905580156111f3576000805461ff00191690555b50505050565b60355490565b609d8054600101908190556101365460ff16611259576040805162461bcd60e51b815260206004820152601460248201527314185d5cd8589b194e881b9bdd081c185d5cd95960621b604482015290519081900360640190fd5b611261612bde565b61126a33612c5d565b60005b610173548110156112fe576112f6610173828154811061128957fe5b6000918252602090912001546001600160a01b0316336112f16112aa6111f9565b6112e56112d861017388815481106112be57fe5b6000918252602090912001546001600160a01b0316612c97565b899063ffffffff612da416565b9063ffffffff612dfd16565b612e3c565b60010161126d565b5061016a54611343906001600160a01b0316336112f161131c6111f9565b61016a546112e590611336906001600160a01b0316612c97565b889063ffffffff612da416565b61134d3383612e5b565b609d548114611391576040805162461bcd60e51b815260206004820152601f6024820152600080516020616126833981519152604482015290519081900360640190fd5b5050565b6101825461016c546101835460408051635ad5aadf60e01b81523060048201526001600160a01b0393841660248201529183166044830152516000939290921691635ad5aadf91606480820192602092909190829003018186803b1580156113fc57600080fd5b505afa158015611410573d6000803e3d6000fd5b505050506040513d602081101561142657600080fd5b5051905090565b734da27a545c0c5b758a6ba100e3a049001de870f581565b6000611452848484612f45565b61145d8484846130f0565b61149b843361149685604051806060016040528060288152602001616248602891396114898a336127ff565b919063ffffffff61323c16565b612aec565b6001600160a01b038416600090815261017660205260409020546114c290849084906132d3565b5060015b9392505050565b610169546001600160a01b031681565b6001600160a01b03808216600090815261017e6020526040902054165b919050565b609d805460010190819055610136546000919060ff161561155a576040805162461bcd60e51b815260206004820152601060248201526f14185d5cd8589b194e881c185d5cd95960821b604482015290519081900360640190fd5b604080513260601b60208083019190915243603480840191909152835180840390910181526054909201909252805191012061017c5561159933612c5d565b60006115a3613353565b61016a549091506115c5906001600160a01b031633308963ffffffff61348716565b6115e1816112e588670de0b6b3a764000063ffffffff612da416565b92506115ed33846134e1565b6115f733846135c1565b6116023384836132d3565b6001600160a01b0384161561165557604080518781526001600160a01b038616602082015281517f496d589d8b7eb829a8d7b30e24a326ac33991f5cea96429b69231a6b15b54b1d929181900390910190a15b50609d54811461169a576040805162461bcd60e51b815260206004820152601f6024820152600080516020616126833981519152604482015290519081900360640190fd5b509392505050565b610182546001600160a01b031681565b606a5460ff1690565b61017381815481106116c957fe5b6000918252602090912001546001600160a01b0316905081565b60006110126116f0612ae8565b846114968560346000611701612ae8565b6001600160a01b03908116825260208083019390935260409182016000908120918c16815292529020549063ffffffff61369116565b611747611742612ae8565b61184e565b6117825760405162461bcd60e51b81526004018080602001828103825260308152602001806161686030913960400191505060405180910390fd5b6101365460ff166117d1576040805162461bcd60e51b815260206004820152601460248201527314185d5cd8589b194e881b9bdd081c185d5cd95960621b604482015290519081900360640190fd5b610136805460ff191690557f5db9ee0a495bf2e6ff9c91a7834c1ba4fdd244a5e8aa4e537bd38aeae4b073aa611805612ae8565b604080516001600160a01b039092168252519081900360200190a1565b61016e546001600160a01b031681565b610177602052600090815260409020546001600160a01b031681565b60006110166101038363ffffffff6136e916565b6101815481565b61187161225a565b6118b0576040805162461bcd60e51b81526020600482018190526024820152600080516020616270833981519152604482015290519081900360640190fd5b61017d80546001600160a01b0319166001600160a01b0383169081179091556110a5576040805162461bcd60e51b81526020600482015260016024820152600360fc1b604482015290519081900360640190fd5b61190c61225a565b61194b576040805162461bcd60e51b81526020600482018190526024820152600080516020616270833981519152604482015290519081900360640190fd5b61016c80546001600160a01b0319166001600160a01b0383169081179091556110a5576040805162461bcd60e51b81526020600482015260016024820152600360fc1b604482015290519081900360640190fd5b60606000806119ad84611e3b565b6101745460408051828152602080840282010190915291925080156119dc578160200160208202803883390190505b50925060005b8351811015611a875761017481815481106119f957fe5b60009182526020808320909101546001600160a01b0390811680845261017983526040808520928a1685529183528184205481855261017a909352922054919450611a6891670de0b6b3a7640000916112e591611a5b9163ffffffff61375016565b859063ffffffff612da416565b848281518110611a7457fe5b60209081029190910101526001016119e2565b505050919050565b73875773784af8135ea0ef43b5a374aad105c5d39e81565b6101715481565b6101365460ff1690565b6101365460009060ff1615611b07576040805162461bcd60e51b815260206004820152601060248201526f14185d5cd8589b194e881c185d5cd95960821b604482015290519081900360640190fd5b609d8054600101905595945050505050565b611b2161225a565b611b60576040805162461bcd60e51b81526020600482018190526024820152600080516020616270833981519152604482015290519081900360640190fd5b61018380546001600160a01b0319166001600160a01b0383169081179091556110a5576040805162461bcd60e51b81526020600482015260016024820152600360fc1b604482015290519081900360640190fd5b61016a546000906001600160a01b03838116911614156114fa57611bf9670de0b6b3a76400006112e5611be56111f9565b611bed613353565b9063ffffffff612da416565b90506114fa565b6101786020526000908152604090205481565b6060610180805480602002602001604051908101604052809291908181526020018280548015610ff357602002820191906000526020600020905b815481526020019060010190808311611c4e575050505050905090565b611c7361225a565b611cb2576040805162461bcd60e51b81526020600482018190526024820152600080516020616270833981519152604482015290519081900360640190fd5b6101728190556127108111156110a5576040805162461bcd60e51b81526020600482015260016024820152603560f81b604482015290519081900360640190fd5b611cfb61225a565b611d3a576040805162461bcd60e51b81526020600482018190526024820152600080516020616270833981519152604482015290519081900360640190fd5b61018280546001600160a01b0319166001600160a01b0383169081179091556110a5576040805162461bcd60e51b81526020600482015260016024820152600360fc1b604482015290519081900360640190fd5b611d9661225a565b611dd5576040805162461bcd60e51b81526020600482018190526024820152600080516020616270833981519152604482015290519081900360640190fd5b61016d80546001600160a01b0319166001600160a01b0383169081179091556110a5576040805162461bcd60e51b81526020600482015260016024820152600360fc1b604482015290519081900360640190fd5b611e39611e34612ae8565b613792565b565b6001600160a01b031660009081526033602052604090205490565b611e5e61225a565b611e9d576040805162461bcd60e51b81526020600482018190526024820152600080516020616270833981519152604482015290519081900360640190fd5b60d0546040516000916001600160a01b031690600080516020616290833981519152908390a360d080546001600160a01b0319169055565b61017481815481106116c957fe5b6000611eed6137db565b905090565b61017d546001600160a01b031681565b6000611eed613353565b600054610100900460ff1680611f255750611f25612bd8565b80611f33575060005460ff16155b611f6e5760405162461bcd60e51b815260040180806020018281038252602e8152602001806162d2602e913960400191505060405180910390fd5b600054610100900460ff16158015611f99576000805460ff1961ff0019909116610100171660011790555b6001609d5580156110a5576000805461ff001916905550565b611fbd611742612ae8565b611ff85760405162461bcd60e51b81526004018080602001828103825260308152602001806161686030913960400191505060405180910390fd5b6110a581613ef8565b61200c611742612ae8565b6120475760405162461bcd60e51b81526004018080602001828103825260308152602001806161686030913960400191505060405180910390fd5b6101365460ff1615612093576040805162461bcd60e51b815260206004820152601060248201526f14185d5cd8589b194e881c185d5cd95960821b604482015290519081900360640190fd5b610136805460ff191660011790557f62e78cea01bee320cd4e420270b5ea74000d11b0c9f74754ebdbfc544b05a258611805612ae8565b6120d261225a565b612111576040805162461bcd60e51b81526020600482018190526024820152600080516020616270833981519152604482015290519081900360640190fd5b61016e80546001600160a01b0319166001600160a01b0383169081179091556110a5576040805162461bcd60e51b81526020600482015260016024820152600360fc1b604482015290519081900360640190fd5b61017960209081526000928352604080842090915290825290205481565b600061101682610174805490506040519080825280602002602001820160405280156121b9578160200160208202803883390190505b50613f41565b6001600160a01b038116600090815261017660205260408120546121e1613353565b915080158015906121f157508082115b1561224557612242620186a06112e5612223612213868663ffffffff61375016565b610172549063ffffffff612da416565b61223686620186a063ffffffff612da416565b9063ffffffff61375016565b91505b50919050565b60d0546001600160a01b031690565b60d0546000906001600160a01b0316612271612ae8565b6001600160a01b031614905090565b60698054604080516020601f6002600019610100600188161502019095169490940493840181900481028201810190925282815260609390929091830182828015610ff35780601f10610fc857610100808354040283529160200191610ff3565b73275da8e61ea8e02d51edd8d0dc5c0e62b4cdb0be81565b6000611012612306612ae8565b84611496856040518060600160405280602581526020016163b46025913960346000612330612ae8565b6001600160a01b03908116825260208083019390935260409182016000908120918d1681529252902054919063ffffffff61323c16565b6060610174805480602002602001604051908101604052809291908181526020018280548015610ff3576020028201919060005260206000209081546001600160a01b031681526001909101906020018083116110f6575050505050905090565b60006123d5338484612f45565b6123e03384846130f0565b336000908152610176602052604090205461101290849084906132d3565b61017a6020526000908152604090205481565b610175818154811061241f57fe5b600091825260209091200154905081565b6101825460408051634a4b15d160e01b8152306004820152905160609283926001600160a01b0390911691634a4b15d191602480820192600092909190829003018186803b15801561248157600080fd5b505afa158015612495573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160409081528110156124be57600080fd5b8101908080516040519392919084600160201b8211156124dd57600080fd5b9083019060208201858111156124f257600080fd5b82518660208202830111600160201b8211171561250e57600080fd5b82525081516020918201928201910280838360005b8381101561253b578181015183820152602001612523565b5050505090500160405260200180516040519392919084600160201b82111561256357600080fd5b90830190602082018581111561257857600080fd5b82518660208202830111600160201b8211171561259457600080fd5b82525081516020918201928201910280838360005b838110156125c15781810151838201526020016125a9565b50505050905001604052505050915091509091565b600061261584848480806020026020016040519081016040528093929190818152602001838360200280828437600092019190915250613f4192505050565b949350505050565b73c00e94cb662c3520282e6f5717214004a7f2688881565b61016d546001600160a01b0316331480612667575061265261224b565b6001600160a01b0316336001600160a01b0316145b61269c576040805162461bcd60e51b81526020600482015260016024820152601b60f91b604482015290519081900360640190fd5b61139182828080602002602001604051908101604052809392919081815260200183836020028082843760009201919091525061404a92505050565b600054610100900460ff16806126f157506126f1612bd8565b806126ff575060005460ff16155b61273a5760405162461bcd60e51b815260040180806020018281038252602e8152602001806162d2602e913960400191505060405180910390fd5b600054610100900460ff16158015612765576000805460ff1961ff0019909116610100171660011790555b61276e82614114565b610136805460ff191690558015611391576000805461ff00191690555050565b61017f5460ff1681565b61016a546000906001600160a01b038481169116146127e2576040805162461bcd60e51b81526020600482015260016024820152603760f81b604482015290519081900360640190fd5b6114c6620186a06112e56101815485612da490919063ffffffff16565b6001600160a01b03918216600090815260346020908152604080832093909416825291909152205490565b6101725481565b61283961225a565b612878576040805162461bcd60e51b81526020600482018190526024820152600080516020616270833981519152604482015290519081900360640190fd5b8685146128b0576040805162461bcd60e51b81526020600482015260016024820152601960f91b604482015290519081900360640190fd5b868110156128e9576040805162461bcd60e51b81526020600482015260016024820152603360f81b604482015290519081900360640190fd5b6128f66101748585615fed565b50600080805b89811015612a66578a8a8281811061291057fe5b905060200201356001600160a01b0316915060006001600160a01b0316826001600160a01b03161415801561296a5750600089898381811061294e57fe5b905060200201356001600160a01b03166001600160a01b031614155b61299f576040805162461bcd60e51b81526020600482015260016024820152600360fc1b604482015290519081900360640190fd5b8888828181106129ab57fe5b6001600160a01b0385811660009081526101776020908152604090912080546001600160a01b0319169390910294909401351617909155508484828181106129ef57fe5b905060200201356001600160a01b0316925073875773784af8135ea0ef43b5a374aad105c5d39e6001600160a01b0316836001600160a01b031614612a5e576001600160a01b03828116600090815261017e6020526040902080546001600160a01b0319169185169190911790555b6001016128fc565b50612a746101738b8b615fed565b5050505050505050505050565b61016f5481565b612a9061225a565b612acf576040805162461bcd60e51b81526020600482018190526024820152600080516020616270833981519152604482015290519081900360640190fd5b6110a5816141cc565b61016a546001600160a01b031681565b3390565b6001600160a01b038316612b315760405162461bcd60e51b81526004018080602001828103825260248152602001806163666024913960400191505060405180910390fd5b6001600160a01b038216612b765760405162461bcd60e51b81526004018080602001828103825260228152602001806161be6022913960400191505060405180910390fd5b6001600160a01b03808416600081815260346020908152604080832094871680845294825291829020859055815185815291517f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b9259281900390910190a3505050565b303b1590565b61017c54324360405160200180836001600160a01b03166001600160a01b031660601b815260140182815260200192505050604051602081830303815290604052805190602001201415611e39576040805162461bcd60e51b81526020600482015260016024820152603960f81b604482015290519081900360640190fd5b6110a58161017480549050604051908082528060200260200182016040528015612c91578160200160208202803883390190505b5061425b565b604080513060248083019190915282518083039091018152604490910182526020810180516001600160e01b03166370a0823160e01b1781529151815160009384936060936001600160a01b03881693919290918291908083835b60208310612d115780518252601f199092019160209182019101612cf2565b6001836020036101000a038019825116818451168082178552505050505050905001915050600060405180830381855afa9150503d8060008114612d71576040519150601f19603f3d011682016040523d82523d6000602084013e612d76565b606091505b509150915081612d8557600080fd5b808060200190516020811015612d9a57600080fd5b5051949350505050565b600082612db357506000611016565b82820282848281612dc057fe5b04146114c65760405162461bcd60e51b81526004018080602001828103825260218152602001806162276021913960400191505060405180910390fd5b60006114c683836040518060400160405280601a815260200179536166654d6174683a206469766973696f6e206279207a65726f60301b8152506145e4565b612e566001600160a01b038416838363ffffffff61464916565b505050565b6001600160a01b038216612ea05760405162461bcd60e51b81526004018080602001828103825260218152602001806163206021913960400191505060405180910390fd5b612ee381604051806060016040528060228152602001616146602291396001600160a01b038516600090815260336020526040902054919063ffffffff61323c16565b6001600160a01b038316600090815260336020526040902055603554612f0f908263ffffffff61375016565b6035556040805182815290516000916001600160a01b038516916000805160206163008339815191529181900360200190a35050565b6000806000806000612f5687611e3b565b905060005b610174548110156130e5576101748181548110612f7457fe5b6000918252602090912001546001600160a01b0316955081612fc6576001600160a01b038681166000908152610179602090815260408083208d8516845290915280822054928b1682529020556130dd565b6001600160a01b03808716600090815261017a60209081526040808320546101798352818420948e1684529390915290205490955061300c90869063ffffffff61375016565b6001600160a01b03808816600090815261017960209081526040808320938d168352929052205490945061305990670de0b6b3a7640000906112e590611a5b90899063ffffffff61375016565b92506130b56130a8613071848a63ffffffff61369116565b6112e5613084888c63ffffffff612da416565b61309c88670de0b6b3a764000063ffffffff612da416565b9063ffffffff61369116565b869063ffffffff61375016565b6001600160a01b03808816600090815261017960209081526040808320938d16835292905220555b600101612f5b565b505050505050505050565b6001600160a01b0383166131355760405162461bcd60e51b81526004018080602001828103825260258152602001806163416025913960400191505060405180910390fd5b6001600160a01b03821661317a5760405162461bcd60e51b81526004018080602001828103825260238152602001806160e36023913960400191505060405180910390fd5b6131bd816040518060600160405280602681526020016161e0602691396001600160a01b038616600090815260336020526040902054919063ffffffff61323c16565b6001600160a01b0380851660009081526033602052604080822093909355908416815220546131f2908263ffffffff61369116565b6001600160a01b03808416600081815260336020908152604091829020949094558051858152905191939287169260008051602061630083398151915292918290030190a3505050565b600081848411156132cb5760405162461bcd60e51b81526004018080602001828103825283818151815260200191508051906020019080838360005b83811015613290578181015183820152602001613278565b50505050905090810190601f1680156132bd5780820380516001836020036101000a031916815260200191505b509250505060405180910390fd5b505050900390565b60006132de84611e3b565b9050613330816112e56132f7858763ffffffff612da416565b61309c61330a868963ffffffff61375016565b6001600160a01b038a16600090815261017660205260409020549063ffffffff612da416565b6001600160a01b0390941660009081526101766020526040902093909355505050565b60008061335e6111f9565b90508061337357505061017054600a0a610ffb565b61016a54600090819061339c90670de0b6b3a764000090611bed906001600160a01b0316612c97565b905060606101738054806020026020016040519081016040528092919081815260200182805480156133f757602002820191906000526020600020905b81546001600160a01b031681526001909101906020018083116133d9575b50939450600093505050505b815181101561346d5781818151811061341857fe5b6020026020010151935061346361345661343186612c97565b6001600160a01b0380881660009081526101776020526040902054611bed911661469b565b849063ffffffff61369116565b9250600101613403565b5061347e828563ffffffff612dfd16565b94505050505090565b604080516001600160a01b0385811660248301528416604482015260648082018490528251808303909101815260849091019091526020810180516001600160e01b03166323b872dd60e01b1790526111f3908590614708565b6001600160a01b03821661353c576040805162461bcd60e51b815260206004820152601f60248201527f45524332303a206d696e7420746f20746865207a65726f206164647265737300604482015290519081900360640190fd5b60355461354f908263ffffffff61369116565b6035556001600160a01b03821660009081526033602052604090205461357b908263ffffffff61369116565b6001600160a01b03831660008181526033602090815260408083209490945583518581529351929391926000805160206163008339815191529281900390910190a35050565b6000806135cd84611e3b565b90506000805b610174548110156136895761017481815481106135ec57fe5b60009182526020808320909101546001600160a01b0390811680845261017983526040808520928b1685529183528184205481855261017a909352922054919550925061365a9061364d9085906112e5906112d8908763ffffffff61375016565b839063ffffffff61369116565b6001600160a01b03808616600090815261017960209081526040808320938b16835292905220556001016135d3565b505050505050565b6000828201838110156114c6576040805162461bcd60e51b815260206004820152601b60248201527a536166654d6174683a206164646974696f6e206f766572666c6f7760281b604482015290519081900360640190fd5b60006001600160a01b0382166137305760405162461bcd60e51b81526004018080602001828103825260228152602001806162b06022913960400191505060405180910390fd5b506001600160a01b03166000908152602091909152604090205460ff1690565b60006114c683836040518060400160405280601e81526020017f536166654d6174683a207375627472616374696f6e206f766572666c6f77000081525061323c565b6137a46101038263ffffffff6148c016565b6040516001600160a01b038216907fcd265ebaf09df2871cc7bd4133404a235ba12eff2041bb89d9c714a2621c7c7e90600090a250565b6101365460009060ff161561382a576040805162461bcd60e51b815260206004820152601060248201526f14185d5cd8589b194e881c185d5cd95960821b604482015290519081900360640190fd5b606061018080548060200260200160405190810160405280929190818152602001828054801561387957602002820191906000526020600020905b815481526020019060010190808311613865575b5050505050905060606101758054806020026020016040519081016040528092919081815260200182805480156138cf57602002820191906000526020600020905b8154815260200190600101908083116138bb575b5050835186519495509384149250508115905061393a5760005b828110806138f5575081155b156139385784818151811061390657fe5b602002602001015184828151811061391a57fe5b6020026020010151146139305760009150613938565b6001016138e9565b505b61016a54600090613953906001600160a01b0316612c97565b9050818015613960575080155b1561397357600095505050505050610ffb565b600061398b620186a06112e561017154611bed614927565b905082156139c357808211156139b4576139b4866139af848463ffffffff61375016565b614a27565b60009650505050505050610ffb565b606060006139cf614bcd565b90925090506139e4818563ffffffff61369116565b905060005b8251811015613a3757613a2f60405180604001604052806007815260200166616d6f756e747360c81b81525082858481518110613a2257fe5b6020026020010151614cee565b6001016139e9565b50613a646040518060400160405280601b8152602001600080516020616106833981519152815250614da4565b60005b61017554811015613ac457613abc6040518060400160405280600f81526020016e6c617374416c6c6f636174696f6e7360881b815250826101758481548110613aac57fe5b9060005260206000200154614cee565b600101613a67565b50613af16040518060400160405280601b8152602001600080516020616106833981519152815250614da4565b60005b8851811015613b4757613b3f60405180604001604052806019815260200178726562616c616e6365724c617374416c6c6f636174696f6e7360381b815250828b8481518110613a2257fe5b600101613af4565b50613b746040518060400160405280601b8152602001600080516020616106833981519152815250614da4565b613ba760405180604001604052806011815260200170746f74616c496e556e6465726c79696e6760781b81525082614e4a565b613bd96040518060400160405280601081526020016f6d6178556e6c656e7442616c616e636560801b81525084614e4a565b6040805180820190915260058152641513d5105360da1b6020820152613c0e90613c09838663ffffffff61375016565b614e4a565b613c3a6040518060400160405280601b8152602001600080516020616106833981519152815250614da4565b6060600080613c6185613c5c8d613c57888b63ffffffff61375016565b614ef8565b615113565b925092509250613c936040518060400160405280601b8152602001600080516020616106833981519152815250614da4565b613cc06040518060400160405280600b81526020016a1d1bdd185b151bd35a5b9d60aa1b81525083614e4a565b613cee6040518060400160405280600c81526020016b6c6f774c697175696469747960a01b8152508261540c565b613d1a6040518060400160405280601b8152602001600080516020616106833981519152815250614da4565b80613d4257613d2c610175600061604c565b8a51613d40906101759060208e019061606a565b505b61016a54600090613d5b906001600160a01b0316612c97565b90508681111580613d6a575082155b15613d845760009c50505050505050505050505050610ffb565b60608451604051908082528060200260200182016040528015613db1578160200160208202803883390190505b50905060005b8551811015613e6857613ded856112e5620186a0898581518110613dd757fe5b6020026020010151612da490919063ffffffff16565b828281518110613df957fe5b602002602001018181525050613e6060405180604001604052806011815260200170746f4d696e74416c6c6f636174696f6e7360781b81525082888481518110613e3f57fe5b6020026020010151858581518110613e5357fe5b60200260200101516154bc565b600101613db7565b50613e956040518060400160405280601b8152602001600080516020616106833981519152815250614da4565b613ea9816139af848b63ffffffff61375016565b604080513381526020810188905281517f4217d9fab39dbadacf1dad6c889aec1caa02e8a6cb59ddd4ce34f3e0ef158b55929181900390910190a160019d505050505050505050505050505090565b613f0a6101038263ffffffff61557a16565b6040516001600160a01b038216907f6719d08c1888103bea251a4ed56406bd0c3e69723c8a1686e017e7bbe159b6f890600090a250565b609d805460010190819055600090613f57612bde565b613f61338461425b565b8315613fff576000613f71613353565b90506000613f91670de0b6b3a76400006112e5888563ffffffff612da416565b61016a54909150600090613fad906001600160a01b0316612c97565b905080821115613fc857613fc187826155fb565b9450613fcc565b8194505b613fd78786856156eb565b9450613fe33388612e5b565b61016a54613ffb906001600160a01b03163387612e3c565b5050505b609d548114614043576040805162461bcd60e51b815260206004820152601f6024820152600080516020616126833981519152604482015290519081900360640190fd5b5092915050565b61017354815114614086576040805162461bcd60e51b81526020600482015260016024820152601960f91b604482015290519081900360640190fd5b6000805b82518110156140c3576140b98382815181106140a257fe5b60200260200101518361369190919063ffffffff16565b915060010161408a565b5081516140d89061018090602085019061606a565b50620186a08114611391576040805162461bcd60e51b81526020600482015260016024820152603760f81b604482015290519081900360640190fd5b600054610100900460ff168061412d575061412d612bd8565b8061413b575060005460ff16155b6141765760405162461bcd60e51b815260040180806020018281038252602e8152602001806162d2602e913960400191505060405180910390fd5b600054610100900460ff161580156141a1576000805460ff1961ff0019909116610100171660011790555b6141aa8261184e565b6141b7576141b782613ef8565b8015611391576000805461ff00191690555050565b6001600160a01b0381166142115760405162461bcd60e51b81526004018080602001828103825260268152602001806161986026913960400191505060405180910390fd5b60d0546040516001600160a01b0380841692169060008051602061629083398151915290600090a360d080546001600160a01b0319166001600160a01b0392909216919091179055565b60606101748054806020026020016040519081016040528092919081815260200182805480156142b457602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311614296575b505050505090508051600014156142cb5750611391565b60006142d56111f9565b905060006142e285611e3b565b9050600082156136895760005b84518110156145db5784818151811061430457fe5b6020026020010151915061431782615779565b600061432283612c97565b905080156143bd576001600160a01b038316600090815261017860205260409020546143939061436d9087906112e590670de0b6b3a764000090611bed90879063ffffffff61375016565b6001600160a01b038516600090815261017a60205260409020549063ffffffff61369116565b6001600160a01b038416600090815261017a60209081526040808320939093556101789052208190555b83156145a0576001600160a01b03808416600081815261017960209081526040808320948d1683529381528382205492825261017a90529182205490919061440b908363ffffffff61375016565b9050801561459d576000614431670de0b6b3a76400006112e5898563ffffffff612da416565b9050600061443e87612c97565b90508082111561444c578091505b8a868151811061445857fe5b6020026020010151156144d8576144b961449361447b8b8b63ffffffff61375016565b6112e585670de0b6b3a764000063ffffffff612da416565b6001600160a01b038916600090815261017a60205260409020549063ffffffff61369116565b6001600160a01b038816600090815261017a602052604090205561459a565b61016e546000906001600160a01b0316158015906144f95750600061017254115b801561452257506001600160a01b03881673875773784af8135ea0ef43b5a374aad105c5d39e14155b1561456057614544620186a06112e56101725486612da490919063ffffffff16565b61016e549091506145609089906001600160a01b031683612e3c565b614575888e6112f1868563ffffffff61375016565b61457e88612c97565b6001600160a01b03891660009081526101786020526040902055505b50505b50505b506001600160a01b03808316600090815261017a60209081526040808320546101798352818420948c168452939091529020556001016142ef565b50505050505050565b600081836146335760405162461bcd60e51b8152602060048201818152835160248401528351909283926044909101919085019080838360008315613290578181015183820152602001613278565b50600083858161463f57fe5b0495945050505050565b604080516001600160a01b038416602482015260448082018490528251808303909101815260649091019091526020810180516001600160e01b031663a9059cbb60e01b179052612e56908490614708565b6000816001600160a01b03166302bbce466040518163ffffffff1660e01b815260040160206040518083038186803b1580156146d657600080fd5b505afa1580156146ea573d6000803e3d6000fd5b505050506040513d602081101561470057600080fd5b505192915050565b61471a826001600160a01b0316615d57565b61476b576040805162461bcd60e51b815260206004820152601f60248201527f5361666545524332303a2063616c6c20746f206e6f6e2d636f6e747261637400604482015290519081900360640190fd5b60006060836001600160a01b0316836040518082805190602001908083835b602083106147a95780518252601f19909201916020918201910161478a565b6001836020036101000a0380198251168184511680821785525050505050509050019150506000604051808303816000865af19150503d806000811461480b576040519150601f19603f3d011682016040523d82523d6000602084013e614810565b606091505b509150915081614867576040805162461bcd60e51b815260206004820181905260248201527f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c6564604482015290519081900360640190fd5b8051156111f35780806020019051602081101561488357600080fd5b50516111f35760405162461bcd60e51b815260040180806020018281038252602a81526020018061638a602a913960400191505060405180910390fd5b6148ca82826136e9565b6149055760405162461bcd60e51b81526004018080602001828103825260218152602001806162066021913960400191505060405180910390fd5b6001600160a01b0316600090815260209190915260409020805460ff19169055565b600080606061017380548060200260200160405190810160405280929190818152602001828054801561498357602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311614965575b50939450600093505050505b8151811015614a05578181815181106149a457fe5b602002602001015192506149fb6149ee670de0b6b3a76400006112e56149c987612c97565b6001600160a01b0380891660009081526101776020526040902054611bed911661469b565b859063ffffffff61369116565b935060010161498f565b5061016a54614a2090613456906001600160a01b0316612c97565b9250505090565b6060614a338383614ef8565b90506000806060610173805480602002602001604051908101604052809291908181526020018280548015614a9157602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311614a73575b50939450600093505050505b84518110156145db57614af26040518060400160405280600f81526020016e70726f746f636f6c416d6f756e747360881b81525082898481518110614ade57fe5b6020026020010151888581518110613e5357fe5b848181518110614afe57fe5b6020026020010151935083600014614bc5576101776000838381518110614b2157fe5b6020908102919091018101516001600160a01b039081168352908201929092526040016000205461016a549082169450614b5d91168486612e3c565b826001600160a01b0316631249c58b6040518163ffffffff1660e01b8152600401602060405180830381600087803b158015614b9857600080fd5b505af1158015614bac573d6000803e3d6000fd5b505050506040513d6020811015614bc257600080fd5b50505b600101614a9d565b60606000806060610173805480602002602001604051908101604052809291908181526020018280548015614c2b57602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311614c0d575b5050505050905060008151905080604051908082528060200260200182016040528015614c62578160200160208202803883390190505b50945060005b81811015614ce657828181518110614c7c57fe5b60200260200101519350614c9e670de0b6b3a76400006112e56149c987612c97565b868281518110614caa57fe5b602002602001018181525050614cdc868281518110614cc557fe5b60200260200101518661369190919063ffffffff16565b9450600101614c68565b505050509091565b612e568383836040516024018080602001848152602001838152602001828103825285818151815260200191508051906020019080838360005b83811015614d40578181015183820152602001614d28565b50505050905090810190601f168015614d6d5780820380516001836020036101000a031916815260200191505b5060408051601f198184030181529190526020810180516001600160e01b031663969cdd0360e01b1790529450615d909350505050565b6110a5816040516024018080602001828103825283818151815260200191508051906020019080838360005b83811015614de8578181015183820152602001614dd0565b50505050905090810190601f168015614e155780820380516001836020036101000a031916815260200191505b5060408051601f198184030181529190526020810180516001600160e01b031663104c13eb60e21b1790529250615d90915050565b61139182826040516024018080602001838152602001828103825284818151815260200191508051906020019080838360005b83811015614e95578181015183820152602001614e7d565b50505050905090810190601f168015614ec25780820380516001836020036101000a031916815260200191505b5060408051601f198184030181529190526020810180516001600160e01b03166309710a9d60e41b1790529350615d9092505050565b60608251604051908082528060200260200182016040528015614f25578160200160208202803883390190505b50905060008080805b8651811015614ff9576000878281518110614f4557fe5b60200260200101511115614f57578091505b614f84620186a06112e5898481518110614f6d57fe5b602002602001015189612da490919063ffffffff16565b9350614f96838563ffffffff61369116565b925083858281518110614fa557fe5b602002602001018181525050614ff1604051806040016040528060178152602001765f616d6f756e747346726f6d416c6c6f636174696f6e7360481b81525082898481518110614ade57fe5b600101614f2e565b506150266040518060400160405280601b8152602001600080516020616106833981519152815250614da4565b6000615038868463ffffffff61375016565b11156150de57604080518082019091526004815263020b232160e51b60208201526150909061506d878563ffffffff61375016565b604051806040016040528060048152602001630103a37960e51b81525084615db1565b6150c56150a3868463ffffffff61375016565b8583815181106150af57fe5b602002602001015161369190919063ffffffff16565b8482815181106150d157fe5b6020026020010181815250505b61510a6040518060400160405280601b8152602001600080516020616106833981519152815250614da4565b50505092915050565b60606000808451604051908082528060200260200182016040528015615143578160200160208202803883390190505b50925060008060008060606101738054806020026020016040519081016040528092919081815260200182805480156151a557602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311615187575b50939450600093505050505b8a518110156153ff578181815181106151c657fe5b602002602001015192508981815181106151dc57fe5b602002602001015193508a81815181106151f257fe5b6020908102919091018101516001600160a01b038086166000908152610177909352604090922054909116965094508385111561536057600061523b868663ffffffff61375016565b90506000876001600160a01b031663743753596040518163ffffffff1660e01b815260040160206040518083038186803b15801561527857600080fd5b505afa15801561528c573d6000803e3d6000fd5b505050506040513d60208110156152a257600080fd5b50519050818110156152cf57600198506152cc620186a06112e583620182b863ffffffff612da416565b91505b615358856153538a6001600160a01b03166302bbce466040518163ffffffff1660e01b815260040160206040518083038186803b15801561530f57600080fd5b505afa158015615323573d6000803e3d6000fd5b505050506040513d602081101561533957600080fd5b50516112e586670de0b6b3a764000063ffffffff612da416565b615ece565b5050506153f7565b615370848663ffffffff61375016565b89828151811061537c57fe5b6020026020010181815250506153ae89828151811061539757fe5b60200260200101518961369190919063ffffffff16565b97506153f76040518060400160405280601081526020016f17dc995919595b505b1b13995959195960821b815250828b84815181106153e957fe5b60200260200101518b6154bc565b6001016151b1565b5050505050509250925092565b604080518215156044820152602481019182528351606482015283516113919285928592829160840190602086019080838360005b83811015615459578181015183820152602001615441565b50505050905090810190601f1680156154865780820380516001836020036101000a031916815260200191505b5060408051601f198184030181529190526020810180516001600160e01b031663c3b5563560e01b1790529350615d9092505050565b6111f3848484846040516024018080602001858152602001848152602001838152602001828103825286818151815260200191508051906020019080838360005b838110156155155781810151838201526020016154fd565b50505050905090810190601f1680156155425780820380516001836020036101000a031916815260200191505b5060408051601f198184030181529190526020810180516001600160e01b03166304772b3360e11b1790529550615d90945050505050565b61558482826136e9565b156155d6576040805162461bcd60e51b815260206004820152601f60248201527f526f6c65733a206163636f756e7420616c72656164792068617320726f6c6500604482015290519081900360640190fd5b6001600160a01b0316600090815260209190915260409020805460ff19166001179055565b60008060006156086111f9565b9050606061017380548060200260200160405190810160405280929190818152602001828054801561566357602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311615645575b50939450600093505050505b81518110156156c95781818151811061568457fe5b602002602001015193506156bf6156b285615353866112e56156a58a612c97565b8d9063ffffffff612da416565b869063ffffffff61369116565b945060010161566f565b506156e16149ee836112e5898963ffffffff612da416565b9695505050505050565b33600090815261017660205260408120548083101561570d57839150506114c6565b600061574769152d02c7e14af68000006112e561017254611bed61573a878a61375090919063ffffffff16565b8b9063ffffffff612da416565b61016a5461016e54919250615769916001600160a01b03918216911683612e3c565b6156e1858263ffffffff61375016565b6001600160a01b03811673c00e94cb662c3520282e6f5717214004a7f2688814806157c057506001600160a01b03811673875773784af8135ea0ef43b5a374aad105c5d39e145b806157e757506001600160a01b038116734da27a545c0c5b758a6ba100e3a049001de870f5145b156110a55760408051600180825281830190925260609160208083019080388339019050509050308160008151811061581c57fe5b6001600160a01b039283166020918202929092010152821673875773784af8135ea0ef43b5a374aad105c5d39e14156159425760408051637e122ea560e11b81526004810191825282516044820152825173275da8e61ea8e02d51edd8d0dc5c0e62b4cdb0be9263fc245d4a92859283929182916024820191606401906020808701910280838360005b838110156158be5781810151838201526020016158a6565b50505050905001838103825284818151815260200191508051906020019060200280838360005b838110156158fd5781810151838201526020016158e5565b50505050905001945050505050600060405180830381600087803b15801561592457600080fd5b505af1158015615938573d6000803e3d6000fd5b50505050506110a5565b604080516001808252818301909252606091602080830190803883390190505090506001600160a01b038316734da27a545c0c5b758a6ba100e3a049001de870f514801561599b5750610183546001600160a01b031615155b15615b97576101835481516001600160a01b039091169082906000906159bd57fe5b60200260200101906001600160a01b031690816001600160a01b0316815250506000816000815181106159ec57fe5b60200260200101516001600160a01b03166375d264136040518163ffffffff1660e01b815260040160206040518083038186803b158015615a2c57600080fd5b505afa158015615a40573d6000803e3d6000fd5b505050506040513d6020811015615a5657600080fd5b505160408051630cc7d40f60e11b815230600482015290519192506001600160a01b03831691633111e7b3918591849163198fa81e916024808301926020929190829003018186803b158015615aab57600080fd5b505afa158015615abf573d6000803e3d6000fd5b505050506040513d6020811015615ad557600080fd5b50516040516001600160e01b031960e085901b168152602481018290523060448201819052606060048301908152845160648401528451919290918291608401906020878101910280838360005b83811015615b3b578181015183820152602001615b23565b50505050905001945050505050602060405180830381600087803b158015615b6257600080fd5b505af1158015615b76573d6000803e3d6000fd5b505050506040513d6020811015615b8c57600080fd5b506110a59350505050565b61016c546001600160a01b031615612e565761016c5481516001600160a01b03909116908290600090615bc657fe5b60200260200101906001600160a01b031690816001600160a01b03168152505080600081518110615bf357fe5b60200260200101516001600160a01b0316635fe3b5676040518163ffffffff1660e01b815260040160206040518083038186803b158015615c3357600080fd5b505afa158015615c47573d6000803e3d6000fd5b505050506040513d6020811015615c5d57600080fd5b50516040516334086fd360e11b81526000604482018190526001606483018190526080600484019081528651608485015286516001600160a01b0390951694636810dfa694889488949093909290918291602482019160a40190602089810191028083838a5b83811015615cdb578181015183820152602001615cc3565b50505050905001838103825286818151815260200191508051906020019060200280838360005b83811015615d1a578181015183820152602001615d02565b505050509050019650505050505050600060405180830381600087803b158015615d4357600080fd5b505af11580156145db573d6000803e3d6000fd5b6000813f7fc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470818114801590612615575050151592915050565b80516a636f6e736f6c652e6c6f67602083016000808483855afa5050505050565b6111f384848484604051602401808060200185815260200180602001848152602001838103835287818151815260200191508051906020019080838360005b83811015615e08578181015183820152602001615df0565b50505050905090810190601f168015615e355780820380516001836020036101000a031916815260200191505b50838103825285518152855160209182019187019080838360005b83811015615e68578181015183820152602001615e50565b50505050905090810190601f168015615e955780820380516001836020036101000a031916815260200191505b5060408051601f198184030181529190526020810180516001600160e01b031663a0c4b22560e01b1790529650615d9095505050505050565b60008115611016576001600160a01b038084166000908152610177602052604090205416615efd848285612e3c565b604080516395a2251f60e01b815230600482015290516001600160a01b038316916395a2251f9160248083019260209291908290030181600087803b158015615f4557600080fd5b505af1158015615f59573d6000803e3d6000fd5b505050506040513d6020811015612d9a57600080fd5b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10615fb057805160ff1916838001178555615fdd565b82800160010185558215615fdd579182015b82811115615fdd578251825591602001919060010190615fc2565b50615fe99291506160a4565b5090565b828054828255906000526020600020908101928215616040579160200282015b828111156160405781546001600160a01b0319166001600160a01b0384351617825560209092019160019091019061600d565b50615fe99291506160be565b50805460008255906000526020600020908101906110a591906160a4565b828054828255906000526020600020908101928215615fdd5791602002820182811115615fdd578251825591602001919060010190615fc2565b610ffb91905b80821115615fe957600081556001016160aa565b610ffb91905b80821115615fe95780546001600160a01b03191681556001016160c456fe45524332303a207472616e7366657220746f20746865207a65726f20616464726573732d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d00000000005265656e7472616e637947756172643a207265656e7472616e742063616c6c0045524332303a206275726e20616d6f756e7420657863656564732062616c616e6365506175736572526f6c653a2063616c6c657220646f6573206e6f742068617665207468652050617573657220726f6c654f776e61626c653a206e6577206f776e657220697320746865207a65726f206164647265737345524332303a20617070726f766520746f20746865207a65726f206164647265737345524332303a207472616e7366657220616d6f756e7420657863656564732062616c616e6365526f6c65733a206163636f756e7420646f6573206e6f74206861766520726f6c65536166654d6174683a206d756c7469706c69636174696f6e206f766572666c6f7745524332303a207472616e7366657220616d6f756e74206578636565647320616c6c6f77616e63654f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e65728be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0526f6c65733a206163636f756e7420697320746865207a65726f2061646472657373436f6e747261637420696e7374616e63652068617320616c7265616479206265656e20696e697469616c697a6564ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef45524332303a206275726e2066726f6d20746865207a65726f206164647265737345524332303a207472616e736665722066726f6d20746865207a65726f206164647265737345524332303a20617070726f76652066726f6d20746865207a65726f20616464726573735361666545524332303a204552433230206f7065726174696f6e20646964206e6f74207375636365656445524332303a2064656372656173656420616c6c6f77616e63652062656c6f77207a65726fa265627a7a72315820c66e0a0fe99712fcb24f0b357a1e480cfaa73e8f3cfacc387136936fcd0b439e64736f6c63430005100032'; // prettier-ignore
  
  function setUp() public virtual {
    _forkAt(blockNumber);
    // _upgradeContract(address(idleUSDC), address(new IdleTokenFungible()));
  }

  function _forkAt(uint256 _block) internal {
    vm.selectFork(vm.createFork(vm.envString("ETH_RPC_URL"), _block));
  }

  function _upgradeContract(address proxy, address newInstance) internal {
    // Upgrade the proxy to the new contract
    IProxyAdmin admin = IProxyAdmin(0x9438904ABC7d8944A6E2A89671fEf51C629af351);
    vm.prank(admin.owner());
    admin.upgrade(proxy, newInstance);
  }

  function testLidoApr() public {
    IdleLidoStrategy idleLidoStrategy = IdleLidoStrategy(stETHLidoStrategy);
    console.log(idleLidoStrategy.getApr());
  }

  function testIdleTokenGovernance() public {

    // do etch
    vm.etch(idleUSDC, IdleTokenRunTimeCode);

    IIdleToken idleToken = IIdleToken(idleUSDC);
    idleToken.rebalance();
  }

  /*
  function testRebalanceFail() public {
    // IdleTokenFungible idleToken = IdleTokenFungible(idleUSDC);
    IIdleToken idleToken = IIdleToken(idleUSDC);

    // Get allocations
    uint256[] memory allocations = idleToken.getAllocations();
    console.log(allocations[0]);
    console.log(allocations[1]);
    console.log(allocations[2]);

    // Set allocations
    // vm.prank(idleToken.rebalancer());
    // uint256[] memory alloc = new uint256[](3);
    // alloc[0] = 20000;
    // alloc[1] = 20000;
    // alloc[2] = 60000;
    // idleToken.setAllocations(alloc);

    idleToken.rebalance();
    // uint256[] memory allocations = idleToken.getAllocations();
    // uint256 avgApr = idleToken.getAvgAPR();
    // console.log(avgApr);
  }
  */
}